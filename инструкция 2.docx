üöÄ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è FOSSBilling —Å StormHosting UA
üìã –≠–¢–ê–ü–´ –ò–ù–¢–ï–ì–†–ê–¶–ò–ò
1. –£–°–¢–ê–ù–û–í–ö–ê –ú–û–î–£–õ–ï–ô –û–ü–õ–ê–¢–´
bash# –°–∫–∞—á–∞–π—Ç–µ —Ñ–∞–π–ª—ã –º–æ–¥—É–ª–µ–π
cd /var/www/bill.sthost.pro
php install_payment_modules.php

# –ò–ª–∏ —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä:
# https://bill.sthost.pro/install_payment_modules.php
2. –ù–ê–°–¢–†–û–ô–ö–ê API –ö–õ–Æ–ß–ï–ô
üü¶ LiqPay:
Public Key: i00000000 (–∏–∑ –∫–∞–±–∏–Ω–µ—Ç–∞ LiqPay)
Private Key: –≤–∞—à_–ø—Ä–∏–≤–∞—Ç–Ω—ã–π_–∫–ª—é—á 
Sandbox: –≤–∫–ª—é—á–∏—Ç—å –¥–ª—è —Ç–µ—Å—Ç–æ–≤
Language: uk
üü™ iPay:
Merchant ID: –≤–∞—à_merchant_id
Secret Key: –≤–∞—à_—Å–µ–∫—Ä–µ—Ç–Ω—ã–π_–∫–ª—é—á
Payment Methods: card,privat24,monobank
Language: uk
üü® Way4Pay:
Merchant Account: –≤–∞—à–µ_–∏–º—è_–º–µ—Ä—á–∞–Ω—Ç–∞
Secret Key: –≤–∞—à_—Å–µ–∫—Ä–µ—Ç–Ω—ã–π_–∫–ª—é—á
Auto Redirect: –¥–∞
Language: uk

üîó –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø –° –°–ê–ô–¢–û–ú
1. –û–ë–ù–û–í–ò–¢–¨ includes/config.php
php// FOSSBilling API –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
define('FOSSBILLING_URL', 'https://bill.sthost.pro');
define('FOSSBILLING_API_URL', 'https://bill.sthost.pro/api');
define('FOSSBILLING_API_TOKEN', '–≤–∞—à_api_—Ç–æ–∫–µ–Ω');

// –ú–∞–ø–ø–∏–Ω–≥ —É—Å–ª—É–≥
$service_types_map = [
    'shared_hosting' => 1,    // ID –ø—Ä–æ–¥—É–∫—Ç–∞ –≤ FOSSBilling
    'cloud_hosting' => 2,
    'reseller_hosting' => 3,
    'vps' => 4,
    'dedicated' => 5,
    'domain_registration' => 6
];
2. –°–û–ó–î–ê–¢–¨ FOSSBilling API –ö–õ–ò–ï–ù–¢
php// –§–∞–π–ª: /includes/fossbilling_client.php
<?php
class FOSSBillingClient {
    private $api_url;
    private $api_token;
    
    public function __construct() {
        $this->api_url = FOSSBILLING_API_URL;
        $this->api_token = FOSSBILLING_API_TOKEN;
    }
    
    // –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞
    public function createClient($clientData) {
        return $this->makeRequest('admin/client/create', $clientData);
    }
    
    // –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞
    public function createOrder($orderData) {
        return $this->makeRequest('admin/order/create', $orderData);
    }
    
    // –ü–æ–ª—É—á–µ–Ω–∏–µ URL –æ–ø–ª–∞—Ç—ã
    public function getPaymentUrl($orderId) {
        return FOSSBILLING_URL . '/order/' . $orderId;
    }
    
    private function makeRequest($endpoint, $data) {
        $data['token'] = $this->api_token;
        
        $ch = curl_init();
        curl_setopt($ch, CURLOPT_URL, $this->api_url . '/' . $endpoint);
        curl_setopt($ch, CURLOPT_POST, true);
        curl_setopt($ch, CURLOPT_POSTFIELDS, http_build_query($data));
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
        curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
        
        $response = curl_exec($ch);
        curl_close($ch);
        
        return json_decode($response, true);
    }
}
?>
3. –û–ë–ù–û–í–ò–¢–¨ –ö–ù–û–ü–ö–ò –ù–ê –°–ê–ô–¢–ï
–ê) –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (/pages/home.php):
javascript// –î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞ –ø–µ—Ä–µ–¥ </body>
<script>
function orderService(serviceType, planId, planName, price) {
    // –ü–æ–∫–∞–∑–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É
    showLoading('–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è...');
    
    // –û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä
    fetch('/api/create_order.php', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'X-CSRF-Token': getCsrfToken()
        },
        body: JSON.stringify({
            service_type: serviceType,
            plan_id: planId,
            plan_name: planName,
            price: price
        })
    })
    .then(response => response.json())
    .then(data => {
        hideLoading();
        if (data.success) {
            // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ FOSSBilling
            window.location.href = data.payment_url;
        } else {
            showError(data.message);
        }
    })
    .catch(error => {
        hideLoading();
        showError('–ü–æ–º–∏–ª–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è');
    });
}

// –û–±–Ω–æ–≤–∏—Ç—å –∫–Ω–æ–ø–∫–∏ –¥–æ–º–µ–Ω–æ–≤
document.querySelectorAll('.domain-btn').forEach(btn => {
    btn.addEventListener('click', function(e) {
        e.preventDefault();
        const card = this.closest('.domain-card');
        const zone = card.querySelector('.domain-zone').textContent;
        const price = parseFloat(card.querySelector('.domain-price').textContent);
        
        orderService('domain_registration', 0, '–î–æ–º–µ–Ω ' + zone, price);
    });
});

// –û–±–Ω–æ–≤–∏—Ç—å –∫–Ω–æ–ø–∫–∏ —Ö–æ—Å—Ç–∏–Ω–≥–∞
document.querySelectorAll('.plan-btn').forEach(btn => {
    btn.addEventListener('click', function(e) {
        e.preventDefault();
        const planId = this.dataset.planId;
        const planName = this.dataset.planName;
        const price = this.dataset.price;
        
        orderService('shared_hosting', planId, planName, price);
    });
});
</script>
–ë) –•–æ—Å—Ç–∏–Ω–≥ —Å—Ç—Ä–∞–Ω–∏—Ü—ã:
php// –í shared.php, cloud.php, reseller.php
// –û–±–Ω–æ–≤–∏—Ç—å JavaScript –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫:

$('#orderForm').on('submit', function(e) {
    e.preventDefault();
    
    const formData = new FormData(this);
    const orderData = {
        service_type: 'shared_hosting',
        plan_id: formData.get('plan_id'),
        plan_name: formData.get('plan_name'), 
        billing_period: formData.get('billing_period'),
        price: calculatePrice(),
        client_data: {
            name: formData.get('client_name'),
            email: formData.get('client_email'),
            phone: formData.get('client_phone')
        }
    };
    
    createFOSSBillingOrder(orderData);
});
–í) VDS —Å—Ç—Ä–∞–Ω–∏—Ü—ã:
php// –í virtual.php, dedicated.php
// –û–±–Ω–æ–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –∑–∞–∫–∞–∑–∞:

function orderVPS(planData) {
    const orderData = {
        service_type: 'vps',
        plan_id: planData.id,
        plan_name: planData.name,
        specifications: planData.specs,
        price: planData.price
    };
    
    createFOSSBillingOrder(orderData);
}
4. –°–û–ó–î–ê–¢–¨ API –û–ë–†–ê–ë–û–¢–ß–ò–ö
php// –§–∞–π–ª: /api/create_order.php
<?php
define('SECURE_ACCESS', true);
require_once '../includes/config.php';
require_once '../includes/fossbilling_client.php';

header('Content-Type: application/json');

try {
    $input = json_decode(file_get_contents('php://input'), true);
    
    if (!$input) {
        throw new Exception('Invalid input data');
    }
    
    $fossbilling = new FOSSBillingClient();
    
    // –°–æ–∑–¥–∞–Ω–∏–µ –∏–ª–∏ –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞
    $clientData = [
        'email' => $input['client_data']['email'] ?? 'guest@sthost.pro',
        'first_name' => $input['client_data']['name'] ?? 'Guest',
        'last_name' => 'User',
        'company' => '',
        'phone' => $input['client_data']['phone'] ?? '',
        'country' => 'UA',
        'password' => bin2hex(random_bytes(8))
    ];
    
    $client = $fossbilling->createClient($clientData);
    
    if (!$client['result']) {
        throw new Exception('Client creation failed');
    }
    
    // –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞
    global $service_types_map;
    $product_id = $service_types_map[$input['service_type']] ?? 1;
    
    $orderData = [
        'client_id' => $client['result']['id'],
        'product_id' => $product_id,
        'period' => $input['billing_period'] ?? '1M',
        'price' => $input['price'],
        'title' => $input['plan_name'],
        'config' => json_encode($input)
    ];
    
    $order = $fossbilling->createOrder($orderData);
    
    if (!$order['result']) {
        throw new Exception('Order creation failed');
    }
    
    // –í–æ–∑–≤—Ä–∞—Ç URL –¥–ª—è –æ–ø–ª–∞—Ç—ã
    echo json_encode([
        'success' => true,
        'order_id' => $order['result']['id'],
        'client_id' => $client['result']['id'],
        'payment_url' => $fossbilling->getPaymentUrl($order['result']['id'])
    ]);
    
} catch (Exception $e) {
    echo json_encode([
        'success' => false,
        'message' => $e->getMessage()
    ]);
}
?>

‚öôÔ∏è –ù–ê–°–¢–†–û–ô–ö–ê –ü–†–û–î–£–ö–¢–û–í –í FOSSBILLING
1. –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–¥—É–∫—Ç—ã:
ID 1: Shared Hosting - –ë–∞–∑–æ–≤–∏–π (99 –≥—Ä–Ω/–º—ñ—Å)
ID 2: Cloud Hosting - –•–º–∞—Ä–Ω–∏–π (199 –≥—Ä–Ω/–º—ñ—Å)  
ID 3: Reseller Hosting - –†–µ—Å–µ–ª–µ—Ä (999 –≥—Ä–Ω/–º—ñ—Å)
ID 4: VPS Hosting - –í—ñ—Ä—Ç—É–∞–ª—å–Ω–∏–π —Å–µ—Ä–≤–µ—Ä (299 –≥—Ä–Ω/–º—ñ—Å)
ID 5: Dedicated Server - –í–∏–¥—ñ–ª–µ–Ω–∏–π —Å–µ—Ä–≤–µ—Ä (1999 –≥—Ä–Ω/–º—ñ—Å)
ID 6: Domain Registration - –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è –¥–æ–º–µ–Ω—É (150 –≥—Ä–Ω/—Ä—ñ–∫)
2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—é:

–ü–æ–¥–∫–ª—é—á–∏—Ç—å cPanel/WHM –¥–ª—è –∞–≤—Ç–æ—Å–æ–∑–¥–∞–Ω–∏—è –∞–∫–∫–∞—É–Ω—Ç–æ–≤
–ù–∞—Å—Ç—Ä–æ–∏—Ç—å email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö –∑–∞–∫–∞–∑–∞—Ö
–í–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–∞–∫—Ç–∏–≤–∞—Ü–∏—é –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã


üîÑ –û–ë–†–ê–ë–û–¢–ö–ê CALLBACK
–§–∞–π–ª: /api/fossbilling_callback.php
php<?php
define('SECURE_ACCESS', true);
require_once '../includes/config.php';

// –û–±—Ä–∞–±–æ—Ç–∫–∞ webhook –æ—Ç FOSSBilling
$input = file_get_contents('php://input');
$data = json_decode($input, true);

if ($data && isset($data['event'])) {
    switch ($data['event']) {
        case 'order_paid':
            // –ó–∞–∫–∞–∑ –æ–ø–ª–∞—á–µ–Ω - –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å —É—Å–ª—É–≥—É
            activateService($data['order_id']);
            break;
            
        case 'order_canceled':
            // –ó–∞–∫–∞–∑ –æ—Ç–º–µ–Ω–µ–Ω
            cancelService($data['order_id']);
            break;
    }
}

function activateService($orderId) {
    // –õ–æ–≥–∏–∫–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ —É—Å–ª—É–≥–∏
    error_log("Order {$orderId} activated");
}

function cancelService($orderId) {
    // –õ–æ–≥–∏–∫–∞ –æ—Ç–º–µ–Ω—ã —É—Å–ª—É–≥–∏  
    error_log("Order {$orderId} canceled");
}

echo 'OK';
?>

üéØ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–æ–¥—É–ª–∏:
bash# –í–æ–π—Ç–∏ –≤ –∞–¥–º–∏–Ω–∫—É FOSSBilling
https://bill.sthost.pro/bb-admin

# Configuration ‚Üí Payment gateways
# –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å LiqPay, iPay, Way4Pay
# –í–≤–µ—Å—Ç–∏ —Ç–µ—Å—Ç–æ–≤—ã–µ –∫–ª—é—á–∏
2. –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ:
LiqPay Sandbox:
–ö–∞—Ä—Ç–∞: 4000000000000002
CVV: 123
–°—Ä–æ–∫: 12/25
iPay Test:
–ö–∞—Ä—Ç–∞: 4444555566661111  
CVV: 111
–°—Ä–æ–∫: 12/25
Way4Pay Test:
–ö–∞—Ä—Ç–∞: 4441114444111115
CVV: 123
–°—Ä–æ–∫: 12/25
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é:

–ó–∞–π—Ç–∏ –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å–∞–π—Ç–∞
–ù–∞–∂–∞—Ç—å "–û–±—Ä–∞—Ç–∏ –ø–ª–∞–Ω"
–ó–∞–ø–æ–ª–Ω–∏—Ç—å —Ñ–æ—Ä–º—É
–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ –≤ FOSSBilling
–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–ø–ª–∞—Ç—É
–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–∫—Ç–∏–≤–∞—Ü–∏—é —É—Å–ª—É–≥–∏


üöÄ –ì–û–¢–û–í–û!
–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤ —É –≤–∞—Å –±—É–¥–µ—Ç:
‚úÖ 3 –ø–ª–∞—Ç–µ–∂–Ω—ã—Ö –º–æ–¥—É–ª—è –¥–ª—è FOSSBilling
‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–∞–π—Ç–æ–º StormHosting UA
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤
‚úÖ –£–∫—Ä–∞–∏–Ω—Å–∫–∏–µ –ø–ª–∞—Ç–µ–∂–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã LiqPay, iPay, Way4Pay
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ —É—Å–ª—É–≥
–í—Å–µ –∫–Ω–æ–ø–∫–∏ –ø–æ–∫—É–ø–∫–∏ –Ω–∞ —Å–∞–π—Ç–µ —Ç–µ–ø–µ—Ä—å –≤–µ–¥—É—Ç –≤ FOSSBilling –¥–ª—è –æ–ø–ª–∞—Ç—ã! üéâ
