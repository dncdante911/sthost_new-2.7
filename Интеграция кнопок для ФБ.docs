üéØ –ú–µ—Å—Ç–∞ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ FossBilling –≤ StormHosting UA
üìã –û–ë–©–ê–Ø –°–¢–†–ê–¢–ï–ì–ò–Ø –ò–ù–¢–ï–ì–†–ê–¶–ò–ò:
–í—Å–µ –∫–Ω–æ–ø–∫–∏ –ø–æ–∫—É–ø–∫–∏ –¥–æ–ª–∂–Ω—ã:

–°–æ–±–∏—Ä–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –æ –≤—ã–±—Ä–∞–Ω–Ω–æ–π —É—Å–ª—É–≥–µ
–°–æ–∑–¥–∞–≤–∞—Ç—å –∑–∞–∫–∞–∑ –≤ FossBilling —á–µ—Ä–µ–∑ API
–ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—Ç—å –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ–ø–ª–∞—Ç—ã FossBilling
–û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å callback –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã


üè† 1. –ì–õ–ê–í–ù–ê–Ø –°–¢–†–ê–ù–ò–¶–ê
üìç –§–∞–π–ª: /pages/home.php
–ú–µ—Å—Ç–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:
–∞) –°–µ–∫—Ü–∏—è "–£—Å–ª—É–≥–∏" - 3 –∫–Ω–æ–ø–∫–∏:
php// –°—Ç—Ä–æ–∫–∏ 243, 283, 323 - –∫–Ω–æ–ø–∫–∏ "–î–µ—Ç–∞–ª—å–Ω—ñ—à–µ"
<a href="/pages/hosting/shared.php" class="service-btn">–î–µ—Ç–∞–ª—å–Ω—ñ—à–µ</a>
‚û§ –ò–ó–ú–ï–ù–ò–¢–¨ –ù–ê:
javascriptonclick="redirectToService('hosting', 'shared')"
onclick="redirectToService('vds', 'virtual')" 
onclick="redirectToService('domains', 'register')"
–±) –°–µ–∫—Ü–∏—è "–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –¥–æ–º–µ–Ω—ã" - 6 –∫–Ω–æ–ø–æ–∫:
php// –°—Ç—Ä–æ–∫–∞ 350+ - –∫–Ω–æ–ø–∫–∏ "–ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏"
<a href="/pages/domains/register.php" class="domain-btn">–ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏</a>
‚û§ –î–û–ë–ê–í–ò–¢–¨:
javascriptonclick="orderDomain('<?php echo $domain['zone']; ?>', <?php echo $domain['price_registration']; ?>)"
–≤) –°–µ–∫—Ü–∏—è "–¢–∞—Ä–∏—Ñ—ã —Ö–æ—Å—Ç–∏–Ω–≥–∞" - 3 –∫–Ω–æ–ø–∫–∏:
php// –°—Ç—Ä–æ–∫–∞ 450+ - –∫–Ω–æ–ø–∫–∏ "–û–±—Ä–∞—Ç–∏ –ø–ª–∞–Ω"
<a href="/pages/hosting/shared.php" class="plan-btn">–û–±—Ä–∞—Ç–∏ –ø–ª–∞–Ω</a>
‚û§ –ò–ó–ú–ï–ù–ò–¢–¨ –ù–ê:
javascriptonclick="orderHostingPlan(<?php echo $plan['id']; ?>, '<?php echo $plan['name_ua']; ?>', <?php echo $plan['price_monthly']; ?>)"

üåê 2. –î–û–ú–ï–ù–ù–ê–Ø –°–ï–ö–¶–ò–Ø
üìç –§–∞–π–ª: /pages/domains/register.php
–ú–µ—Å—Ç–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:
–∞) –§–æ—Ä–º–∞ –ø–æ–∏—Å–∫–∞ –¥–æ–º–µ–Ω–æ–≤:
php// –í JavaScript —Å–µ–∫—Ü–∏–∏ - —Ñ—É–Ω–∫—Ü–∏—è –ø–æ–∏—Å–∫–∞
function searchDomain() {
    // –ü–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
    if (domain.available) {
        showOrderButton(domain.name, domain.price);
    }
}
‚û§ –î–û–ë–ê–í–ò–¢–¨:
javascriptfunction orderDomain(domainName, price, zone) {
    // –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ –≤ FossBilling
    fetch('/api/domains/order.php', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({
            action: 'create_order',
            domain: domainName,
            zone: zone,
            price: price,
            service_type: 'domain_registration'
        })
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ FossBilling
            window.location.href = data.fossbilling_url;
        }
    });
}
üìç –§–∞–π–ª: /pages/domains/transfer.php
–ö–Ω–æ–ø–∫–∞ "–ü–æ–¥–∞—Ç–∏ –∑–∞—è–≤–∫—É" - –¥–æ–±–∞–≤–∏—Ç—å –∑–∞–∫–∞–∑ —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä–∞ —á–µ—Ä–µ–∑ FossBilling

üñ•Ô∏è 3. –•–û–°–¢–ò–ù–ì –°–ï–ö–¶–ò–Ø
üìç –§–∞–π–ª: /pages/hosting/shared.php
–ú–µ—Å—Ç–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:
–∞) –ö–Ω–æ–ø–∫–∏ –ø–ª–∞–Ω–æ–≤ —Ö–æ—Å—Ç–∏–Ω–≥–∞:
php// –°—Ç—Ä–æ–∫–∞ 180+ - –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ –∑–∞–∫–∞–∑–∞
<button type="submit" class="btn btn-primary">–ó–∞–º–æ–≤–∏—Ç–∏ –ø–ª–∞–Ω</button>
‚û§ –ò–ó–ú–ï–ù–ò–¢–¨ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ñ–æ—Ä–º—ã:
javascript$('#orderForm').on('submit', function(e) {
    e.preventDefault();
    
    const formData = new FormData(this);
    const orderData = {
        action: 'create_order',
        plan_id: formData.get('plan_id'),
        plan_name: formData.get('plan_name'),
        billing_period: formData.get('billing_period'),
        price: calculatePrice(),
        service_type: 'shared_hosting'
    };
    
    // –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ FossBilling
    createFossBillingOrder(orderData);
});
üìç –§–∞–π–ª: /pages/hosting/cloud.php
–ö–Ω–æ–ø–∫–∞ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ "–ó–∞–º–æ–≤–∏—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é":
javascript// –í —Ñ—É–Ω–∫—Ü–∏–∏ –∑–∞–∫–∞–∑–∞
function orderCloudConfig() {
    const config = getCurrentConfig();
    const orderData = {
        action: 'create_order',
        service_type: 'cloud_hosting',
        configuration: config,
        price: config.total_price
    };
    
    createFossBillingOrder(orderData);
}
üìç –§–∞–π–ª: /pages/hosting/reseller.php
4 –∫–Ω–æ–ø–∫–∏ –ø–ª–∞–Ω–æ–≤ —Ä–µ—Å–µ–ª–ª–µ—Ä–∞:
javascriptfunction orderReseller(planType) {
    const plans = {
        'start': {id: 1, name: 'Reseller Start', price: 1499},
        'pro': {id: 2, name: 'Reseller Pro', price: 2999},
        // ...
    };
    
    createFossBillingOrder({
        action: 'create_order',
        service_type: 'reseller_hosting',
        plan: plans[planType]
    });
}

üíª 4. VDS/VPS –°–ï–ö–¶–ò–Ø
üìç –§–∞–π–ª: /pages/vds/virtual.php
4 –∫–Ω–æ–ø–∫–∏ VPS –ø–ª–∞–Ω–æ–≤:
javascript// –í –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–µ –∑–∞–∫–∞–∑–∞
function orderVPS(planData) {
    fetch('/api/vds/order.php', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({
            action: 'create_order',
            plan_id: planData.id,
            service_type: 'vps',
            specifications: planData.specs,
            price: planData.price
        })
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            window.location.href = data.payment_link;
        }
    });
}
üìç –§–∞–π–ª: /pages/vds/dedicated.php
4 –∫–Ω–æ–ø–∫–∏ Dedicated —Å–µ—Ä–≤–µ—Ä–æ–≤ - –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ VPS
üìç –§–∞–π–ª: /pages/vds/vds-calc.php
–ö–Ω–æ–ø–∫–∞ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ "–ó–∞–º–æ–≤–∏—Ç–∏"

üìß 5. –°–û–ó–î–ê–¢–¨ API –§–ê–ô–õ–´
üìç –°–æ–∑–¥–∞—Ç—å: /api/fossbilling/client.php
php<?php
class FossBillingClient {
    private $api_url;
    private $api_token;
    
    public function __construct() {
        $this->api_url = FOSSBILLING_URL . '/api';
        $this->api_token = FOSSBILLING_API_TOKEN;
    }
    
    public function createOrder($orderData) {
        return $this->makeRequest('admin/order/create', $orderData);
    }
    
    public function createProduct($productData) {
        return $this->makeRequest('admin/product/create', $productData);
    }
    
    public function getOrderStatus($orderId) {
        return $this->makeRequest('admin/order/get', ['id' => $orderId]);
    }
    
    private function makeRequest($endpoint, $data) {
        // HTTP –∑–∞–ø—Ä–æ—Å –∫ FossBilling API
        $curl = curl_init();
        curl_setopt_array($curl, [
            CURLOPT_URL => $this->api_url . '/' . $endpoint,
            CURLOPT_POST => true,
            CURLOPT_POSTFIELDS => json_encode($data),
            CURLOPT_HTTPHEADER => [
                'Content-Type: application/json',
                'Authorization: Bearer ' . $this->api_token
            ],
            CURLOPT_RETURNTRANSFER => true
        ]);
        
        $response = curl_exec($curl);
        curl_close($curl);
        
        return json_decode($response, true);
    }
}
?>
üìç –°–æ–∑–¥–∞—Ç—å: /api/orders/create.php
php<?php
require_once '../fossbilling/client.php';

$fossBilling = new FossBillingClient();

// –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–∞
$input = json_decode(file_get_contents('php://input'), true);

// –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞ –≤ FossBilling
$product = $fossBilling->createProduct([
    'type' => $input['service_type'],
    'title' => $input['plan_name'],
    'price' => $input['price']
]);

// –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞
$order = $fossBilling->createOrder([
    'product_id' => $product['id'],
    'client_id' => getCurrentClientId(),
    'period' => $input['billing_period'] ?? 'monthly'
]);

// –í–æ–∑–≤—Ä–∞—Ç —Å—Å—ã–ª–∫–∏ –Ω–∞ –æ–ø–ª–∞—Ç—É
echo json_encode([
    'success' => true,
    'order_id' => $order['id'],
    'payment_link' => FOSSBILLING_URL . '/order/' . $order['id'],
    'fossbilling_url' => FOSSBILLING_URL . '/cart'
]);
?>

‚öôÔ∏è 6. –û–ë–©–ê–Ø JAVASCRIPT –§–£–ù–ö–¶–ò–Ø
üìç –î–æ–±–∞–≤–∏—Ç—å –≤: /assets/js/main.js
javascript// –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞
function createFossBillingOrder(orderData) {
    // –ü–æ–∫–∞–∑–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É
    showLoading('–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è...');
    
    fetch('/api/orders/create.php', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'X-CSRF-Token': getCsrfToken()
        },
        body: JSON.stringify(orderData)
    })
    .then(response => response.json())
    .then(data => {
        hideLoading();
        
        if (data.success) {
            // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ FossBilling
            window.location.href = data.payment_link;
        } else {
            showError(data.message || '–ü–æ–º–∏–ª–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è');
        }
    })
    .catch(error => {
        hideLoading();
        showError('–ü–æ–º–∏–ª–∫–∞ –∑\'—î–¥–Ω–∞–Ω–Ω—è –∑ —Å–µ—Ä–≤–µ—Ä–æ–º');
        console.error('Order creation error:', error);
    });
}

// –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞ (–∏–∑ —Å–µ—Å—Å–∏–∏ –∏–ª–∏ —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ)
function getCurrentClientId() {
    // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω - –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –µ–≥–æ ID
    // –ï—Å–ª–∏ –Ω–µ—Ç - —Å–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞ –≤ FossBilling
    return localStorage.getItem('client_id') || null;
}

// –ü–æ–∫–∞–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
function showLoading(message) {
    // –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏–Ω–Ω–µ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
}

function showError(message) {
    // –ü–æ–∫–∞–∑–∞—Ç—å –æ—à–∏–±–∫—É
}

üîß 7. –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø
üìç –û–±–Ω–æ–≤–∏—Ç—å: /includes/config.php
php// FossBilling –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (—É–∂–µ –µ—Å—Ç—å)
define('FOSSBILLING_URL', 'https://bill.sthost.pro');
define('FOSSBILLING_API_TOKEN', '–≤–∞—à_api_—Ç–æ–∫–µ–Ω_–æ—Ç_fossbilling');

// –ú–∞–ø–ø–∏–Ω–≥ —Ç–∏–ø–æ–≤ —É—Å–ª—É–≥
$service_types_mapping = [
    'shared_hosting' => 'hosting',
    'cloud_hosting' => 'hosting_cloud', 
    'reseller_hosting' => 'hosting_reseller',
    'vps' => 'vps',
    'dedicated' => 'dedicated',
    'domain_registration' => 'domain',
    'domain_transfer' => 'domain_transfer'
];

üìù –ò–¢–û–ì–û: –°–ü–ò–°–û–ö –§–ê–ô–õ–û–í –î–õ–Ø –ò–ó–ú–ï–ù–ï–ù–ò–Ø
–û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å –∫–Ω–æ–ø–∫–∞–º–∏:

‚úÖ /pages/home.php - 12+ –∫–Ω–æ–ø–æ–∫ –ø–æ–∫—É–ø–∫–∏
‚úÖ /pages/domains/register.php - –∫–Ω–æ–ø–∫–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
‚úÖ /pages/domains/transfer.php - –∫–Ω–æ–ø–∫–∞ —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä–∞
‚úÖ /pages/hosting/shared.php - 4 –∫–Ω–æ–ø–∫–∏ –ø–ª–∞–Ω–æ–≤
‚úÖ /pages/hosting/cloud.php - –∫–Ω–æ–ø–∫–∞ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞
‚úÖ /pages/hosting/reseller.php - 4 –∫–Ω–æ–ø–∫–∏ –ø–ª–∞–Ω–æ–≤
‚úÖ /pages/vds/virtual.php - 4 –∫–Ω–æ–ø–∫–∏ VPS
‚úÖ /pages/vds/dedicated.php - 4 –∫–Ω–æ–ø–∫–∏ Dedicated
‚úÖ /pages/vds/vds-calc.php - –∫–Ω–æ–ø–∫–∞ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞

API —Ñ–∞–π–ª—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è:

üÜï /api/fossbilling/client.php - –∫–ª–∏–µ–Ω—Ç FossBilling
üÜï /api/orders/create.php - —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤
üÜï /api/domains/order.php - –∑–∞–∫–∞–∑—ã –¥–æ–º–µ–Ω–æ–≤
üÜï /api/callback/fossbilling.php - –æ–±—Ä–∞–±–æ—Ç–∫–∞ callback

–û–±–Ω–æ–≤–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ:

‚úÖ /assets/js/main.js - –æ–±—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
‚úÖ /includes/config.php - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ FossBilling

–í—Å–µ–≥–æ: ~50 –∫–Ω–æ–ø–æ–∫ –ø–æ–∫—É–ø–∫–∏ –Ω—É–∂–Ω–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å FossBilling! üéØ
–í—Å–µ, –¥—É–º–∞—é —Å–∞–π—Ç –≥–æ—Ç–æ–≤. –¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π –ø—Ä–æ–±–µ–≥–∏—Å—å –ø–æ –í–°–ï–ú–£ –∫–æ–¥—É, –ø–æ –í–°–ï–ú —Ñ–∞–π–ª–∞–º (–µ—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ –≥–∏—Ç—Ö–∞–±—É, –Ω–∞–ø–æ–º–∏–Ω–∞—é), –∏ –Ω–∞–ø–∏—à–∏ –≤ —Ç–µ—Ö –º–µ—Å—Ç–∞—Ö, –≥–¥–µ –µ—Å—Ç—å –∫–Ω–æ–ø–∫–∏ –ø–æ–∫—É–ø–æ–∫ –∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤, –∫–∞–∫ —Ç–∞–º –≤—Å—Ç—Ä–æ–∏—Ç—å –∫–æ–¥, —á—Ç–æ –±—ã –±—ã–ª–∞ –æ–ø–ª–∞—Ç–∞ —á–µ—Ä–µ–∑ FossBilling. –í–µ—Å—å –∫–æ–¥ –ø–∏—Å–∞—Ç—å –Ω–µ –Ω—É–∂–Ω–æ, —á–∏—Å—Ç–æ —É–∫–∞–∂–∏ –º–µ—Å—Ç–∞ –≥–¥–µ –Ω–∞–¥–æ –∏–∑–º–µ–Ω–∏—Ç—å, —á—Ç–æ –±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –ø–æ–∫—É–ø–∞—Ç—å/–æ–ø–ª–∞—á–∏–≤–∞—Ç—å —É—Å–ª—É–≥–∏.
